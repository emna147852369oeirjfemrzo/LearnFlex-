{% extends 'base.html.twig' %}

{% block title %}Nouvelle Publication{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('assets/css/styles.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">
<style>
/* Navbar comme sur la page d'accueil */
.main-navbar {
    background: white;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    padding: 1rem 0;
}

.main-navbar .navbar-brand {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.5rem;
    font-weight: 700;
    color: #1e3a5f;
}

.main-navbar .navbar-brand img {
    height: 40px;
}

.main-navbar .nav-link {
    color: #1e3a5f;
    font-weight: 500;
    padding: 0.5rem 1rem;
    transition: color 0.3s;
}

.main-navbar .nav-link:hover {
    color: #667eea;
}

.btn-connexion {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 0.5rem 1.5rem;
    border-radius: 25px;
    border: none;
    font-weight: 600;
}

/* Header */
.page-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 3rem 0;
    margin-bottom: 2rem;
}

/* Cartes de catégories */
.category-card {
    border: 2px solid #e9ecef;
    border-radius: 16px;
    padding: 2rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    background: white;
}

.category-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    border-color: #667eea;
}

.category-card.selected {
    border-color: #667eea;
    background: #f8f9ff;
    box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
}

.category-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
}

.form-card {
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    padding: 2rem;
}
</style>
{% endblock %}

{% block body %}
{# Navbar #}
<nav class="main-navbar">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center">
            <a class="navbar-brand" href="{{ path('app_front') }}">
                <img src="{{ asset('assets/images/logo1.png') }}" alt="LearnFlex+">
                <span>LearnFlex +</span>
            </a>
            <div class="d-flex gap-3 align-items-center">
                <a href="{{ path('app_front') }}" class="nav-link">Accueil</a>
                <a href="#" class="nav-link">Contenus pédagogiques</a>
                <a href="#" class="nav-link">Evaluation</a>
                <a href="#" class="nav-link">Questionnaire</a>
                <a href="#" class="nav-link">Orientation</a>
                <a href="{{ path('forum_index') }}" class="nav-link">Forum</a>
                <button class="btn btn-connexion">Connexion</button>
            </div>
        </div>
    </div>
</nav>

{# Header #}
<div class="page-header">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ path('app_front') }}" class="text-white text-decoration-none">Accueil</a></li>
                <li class="breadcrumb-item"><a href="{{ path('forum_index') }}" class="text-white text-decoration-none">Forum</a></li>
                <li class="breadcrumb-item active text-white">Nouvelle Publication</li>
            </ol>
        </nav>
        <h1 class="display-5 fw-bold">Créer une publication</h1>
        <p class="lead">Partagez vos questions, connaissances ou discussions avec la communauté</p>
    </div>
</div>

<div class="container mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="form-card">
                {{ form_start(form) }}
                    <div class="mb-4">
                        {{ form_label(form.titre, 'Titre de la publication', {'label_attr': {'class': 'form-label fw-bold text-dark'}}) }}
                        {{ form_widget(form.titre, {'attr': {'class': 'form-control', 'placeholder': 'Ex: Comment résoudre cette équation ?'}}) }}
                        {{ form_errors(form.titre) }}
                    </div>
                    
                    <div class="mb-4">
                        {{ form_label(form.description, 'Description', {'label_attr': {'class': 'form-label fw-bold text-dark'}}) }}
                        {{ form_widget(form.description, {'attr': {'class': 'form-control', 'rows': 6, 'placeholder': 'Décrivez votre question ou discussion en détail...'}}) }}
                        {{ form_errors(form.description) }}
                    </div>
                    
                    <div class="mb-4">
                        <label class="form-label fw-bold text-dark"><i class="fas fa-folder me-2"></i> Catégorie</label>
                        
                        {# Cartes visuelles pour les catégories #}
                        <div class="row g-3 mb-3">
                            <div class="col-md-4">
                                <div class="category-card" onclick="selectCategory('question_cours')">
                                    <div class="category-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                        <i class="fas fa-graduation-cap fa-2x text-white"></i>
                                    </div>
                                    <h5 class="mt-3 text-dark">Cours</h5>
                                    <p class="text-muted small">Partage de connaissances et tutoriels</p>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="category-card" onclick="selectCategory('question_examen')">
                                    <div class="category-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                        <i class="fas fa-question-circle fa-2x text-white"></i>
                                    </div>
                                    <h5 class="mt-3 text-dark">Question</h5>
                                    <p class="text-muted small">Demande d'aide ou de clarification</p>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="category-card" onclick="selectCategory('reclamation')">
                                    <div class="category-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                        <i class="fas fa-comments fa-2x text-white"></i>
                                    </div>
                                    <h5 class="mt-3 text-dark">Discussion</h5>
                                    <p class="text-muted small">Échange d'idées et débats</p>
                                </div>
                            </div>
                        </div>
                        
                        {# Select caché pour la soumission du formulaire #}
                        <div style="display: none;">
                            {{ form_widget(form.categorie, {'attr': {'id': 'categorie-select'}}) }}
                        </div>
                        {{ form_errors(form.categorie) }}
                    </div>
                    
                    <div class="d-flex gap-3">
                        <button type="submit" class="btn btn-success btn-lg">
                            <i class="fas fa-paper-plane me-2"></i>
                            Publier
                        </button>
                        <a href="{{ path('forum_index') }}" class="btn btn-secondary btn-lg">
                            <i class="fas fa-times me-2"></i>
                            Annuler
                        </a>
                    </div>
                {{ form_end(form) }}
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
<script>
function selectCategory(value) {
    // Retirer la sélection de toutes les cartes
    document.querySelectorAll('.category-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // Sélectionner la carte cliquée
    event.currentTarget.classList.add('selected');
    
    // Mettre à jour le select caché
    document.getElementById('categorie-select').value = value;
}
</script>
{% endblock %}