{# quiz/_modals.html.twig #}

<!-- Modal Ajouter un Quiz -->
<div id="quizModalOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
     background: rgba(0,0,0,0.5); backdrop-filter: blur(5px); z-index:1000; justify-content:center; align-items:center;">
    <div id="quizModal" style="background:white; padding:20px; border-radius:8px; max-width:600px; width:90%; box-shadow:0 0 20px rgba(0,0,0,0.3); position:relative;">
        <span id="closeQuizModal" style="position:absolute; top:10px; right:15px; font-size:20px; cursor:pointer;">&times;</span>
        <h3>Ajouter un nouveau Quiz</h3>

        {{ form_start(form) }}
            {{ form_row(form.titre) }}
            {{ form_row(form.question) }}
            {{ form_row(form.description) }}
            {{ form_row(form.duree) }}
            {{ form_row(form.etat) }}
            <div style="margin-top:15px; display:flex; gap:10px;">
                <button type="submit" class="btn btn-primary">Ajouter</button>
                <button type="button" id="cancelQuizModal" class="btn btn-outline">Annuler</button>
            </div>
        {{ form_end(form) }}
    </div>
</div>

<!-- Modal Modifier un Quiz -->
<div id="editQuizModalOverlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:1000; justify-content:center; align-items:center;">
    <div style="background:white; padding:20px; border-radius:8px; width:90%; max-width:600px; position:relative;">
        <span id="closeEditQuizModal" style="position:absolute; top:10px; right:15px; cursor:pointer;">&times;</span>

        <h3>Modifier le Quiz</h3>

        <form id="editQuizForm" method="post">
            <input type="hidden" name="_token" value="{{ csrf_token('edit_quiz') }}">

            <div>
                <label>Titre</label>
                <input type="text" name="quiz[titre]" id="editTitre" class="form-control">
            </div>

            <div>
                <label>Question</label>
                <textarea name="quiz[question]" id="editQuestion" class="form-control"></textarea>
            </div>

            <div>
                <label>Description</label>
                <textarea name="quiz[description]" id="editDescription" class="form-control"></textarea>
            </div>

            <div>
                <label>Durée</label>
                <input type="number" name="quiz[duree]" id="editDuree" class="form-control">
            </div>

            <div>
                <label>État</label>
                <select name="quiz[etat]" id="editEtat" class="form-control">
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                </select>
            </div>

            <div style="margin-top:15px; display:flex; gap:10px;">
                <button class="btn btn-primary">Enregistrer</button>
                <button type="button" id="cancelEditQuizModal" class="btn btn-outline">Annuler</button>
            </div>
        </form>
    </div>
</div>

<!-- JS pour ouvrir/fermer les modals -->
<script>
    // Modal Ajouter Quiz
    const openBtn = document.getElementById('openQuizModal');
    const overlay = document.getElementById('quizModalOverlay');
    const closeBtn = document.getElementById('closeQuizModal');
    const cancelBtn = document.getElementById('cancelQuizModal');

    openBtn.addEventListener('click', () => overlay.style.display = 'flex');
    closeBtn.addEventListener('click', () => overlay.style.display = 'none');
    cancelBtn.addEventListener('click', () => overlay.style.display = 'none');
    overlay.addEventListener('click', (e) => { if(e.target === overlay) overlay.style.display = 'none'; });

    // Modal Modifier Quiz
    const editButtons = document.querySelectorAll('.action-btn.edit');
    const editOverlay = document.getElementById('editQuizModalOverlay');
    const editForm = document.getElementById('editQuizForm');

    editButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            const id = btn.dataset.id;

            document.getElementById('editTitre').value = btn.dataset.titre;
            document.getElementById('editQuestion').value = btn.dataset.question;
            document.getElementById('editDescription').value = btn.dataset.description;
            document.getElementById('editDuree').value = btn.dataset.duree;
            document.getElementById('editEtat').value = btn.dataset.etat;

            editForm.action = `/quiz/${id}/edit`;
            editOverlay.style.display = 'flex';
        });
    });

    document.getElementById('closeEditQuizModal').onclick =
    document.getElementById('cancelEditQuizModal').onclick = () => {
        editOverlay.style.display = 'none';
    };
</script>
